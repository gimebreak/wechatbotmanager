{% extends 'admin/master.html' %}
{% block body %}
{{ super() }}
<div class="container">
    <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
            <h1>Flask-Admin example</h1>

            {% if current_user.is_authenticated %}

            <p class="lead">
                Authentication
            </p>
                  {% if qrimg %}
                {{ qrimg | safe }}
                {% endif %}
            {% endif %}
            {% if not current_user.is_authenticated %}
            <p>You can register as a regular user, or log in as a superuser with the following credentials:
            <ul>
                <li>email: <b>admin</b></li>
                <li>password: <b>admin</b></li>
            </ul>
            <p>
                <a class="btn btn-primary" href="{{ url_for('security.login') }}">login</a> <a class="btn btn-default" href="{{ url_for('security.register') }}">register</a>
            </p>
            {% endif %}
            <p>
                <a class="btn btn-primary" href="/"><i class="glyphicon glyphicon-chevron-left"></i> Back</a>
            </p>
        </div>
    </div>
</div>
<script>
    var check = setInterval(function(){
           $.ajax({
               url:'/check_login',
               type:'get',
               success:function(data){
                        if(data.isLoggedIn === true){
                            console.log(data.isLoggedIn);
                            clearInterval(check);
                            $('#qrimg').after('<h2>已登录</h2>');

                            $('#qrimg').remove();


                        }
                    }
           })
       },2000);
</script>
{% endblock body %}
